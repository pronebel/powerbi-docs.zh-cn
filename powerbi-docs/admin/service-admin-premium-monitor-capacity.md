---
title: 使用 Premium Capacity Metrics 应用监视 Power BI Premium 功能。
description: 使用 Power BI 管理门户和 Power BI Premium Capacity Metrics 应用
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-premium
ms.topic: how-to
ms.date: 11/11/2020
LocalizationGroup: Premium
ms.openlocfilehash: 46e2684b468e480da5db5287ffc40466d71c8f22
ms.sourcegitcommit: cc20b476a45bccb870c9de1d0b384e2c39e25d24
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/11/2020
ms.locfileid: "94512208"
---
# <a name="monitor-premium-capacities-with-the-app"></a>使用应用监视高级容量

监视容量对于正确决定如何充分利用高级容量资源至关重要。 可以在管理门户中或使用 Power BI Premium Capacity Metrics 应用监视容量。 本文介绍如何使用 Premium Capacity Metrics 应用。 应用提供有关容量性能的深度信息。 有关过去七天内平均使用量指标的更高级别概述，可以使用管理门户。 要了解在门户中监视的详细信息，请参阅[在管理门户中监视高级容量](service-admin-premium-monitor-portal.md)。

应用定期更新新特性和新功能。 请确保正在运行最新版本。 有新版本可用时，你将收到[通知](../connect-data/service-template-apps-install-distribute.md#update-a-template-app)。

> [!IMPORTANT]
> 如果 Power BI Premium 容量遇到资源使用量过高的情况，从而导致性能或可靠性问题，可通过接收通知电子邮件来识别和解决问题。 这可以充当一种用于排查重载容量的简化方法。 有关详细信息，请参阅[容量和可靠性通知](service-interruption-notifications.md#capacity-and-reliability-notifications)。

> [!NOTE]
> Power BI Premium 最近发布了 Premium 的新版本，名为 Premium Gen2，目前为预览版。 Premium Gen2 将简化高级容量的管理，并减少管理开销。 有关详细信息，请参阅 [Power BI Premium 第二代（预览版）](service-premium-what-is.md#power-bi-premium-generation-2-preview)。

## <a name="install-the-app"></a>安装应用

请转到[连接到 Power BI Premium Capacity Metrics](../connect-data/service-connect-to-pbi-premium-capacity-metrics.md)，了解如何安装应用并连接到数据。 也可[直接转到应用](https://go.microsoft.com/fwlink/?linkid=2114036)。

## <a name="get-app-refresh-history"></a>获取应用刷新历史记录

查看上次刷新 Premium Capacity Metrics 应用的时间：

1. 转到随应用一起安装的工作区。

   ![转到应用工作区](media/service-admin-premium-monitor-capacity/settings-refresh-history.png)

1. 单击数据集行上的“计划刷新”按钮。

   ![“计划刷新”按钮](media/service-admin-premium-monitor-capacity/schedule-refresh.png)

   显示上次刷新时间。 单击“刷新历史记录”可查看计划的刷新或按需刷新。

   ![上次刷新时间](media/service-admin-premium-monitor-capacity/settings-last-refresh.png)

## <a name="monitor-capacities-with-the-app"></a>使用应用监视容量

现在你已经安装了应用，可以查看有关组织容量的指标。 应用提供仪表板，其中包含指标摘要和详细指标报表。

### <a name="dashboard"></a>仪表板

若要查看汇总了你作为管理员的主要容量指标的仪表板，请在“仪表板”中单击“Power BI Premium 容量指标”。 随即将出现仪表板。

![指标应用仪表板](media/service-admin-premium-monitor-capacity/app-dashboard.png)

仪表板包含以下指标：

#### <a name="top"></a>顶部

| 指标 | 说明 |
| --- | --- |
| 版本 | 应用版本。 | 
| 容量 | 你作为管理员所管理的容量数。 | 
| 工作区 | 报告了指标的容量中的工作区数。|
|||

#### <a name="system-summary"></a>系统摘要

| 指标 | 说明 |
| --- | --- |
| CPU 最高利用率容量 | 过去七天内 CPU 超过阈值的 80% 的最大次数的容量。 |
| CPU 最高利用率计数 | 过去七天内 CPU 命名容量超过阈值的 80% 的次数。 | 
| 内存最大利用率容量 | 过去七天内达到最大内存限制的最大次数的容量（按三分钟的时间段划分）。  |
| 内存最大利用率计数| 过去七天内命名容量达到最大内存限制的次数（按三分钟的时间段划分）。 |
|||

#### <a name="dataset-summary"></a>数据集摘要

| 指标 | 说明 |
| --- | --- |
| 数据集 | 容量中所有工作区的数据集总量。|
| 数据集的平均大小 (MB) | 容量中所有工作区的数据集的平均大小。|  
| 数据集平均加载计数 | 加载到内存中的数据集的平均计数。 |  
| 数据集 - 平均活动数据集 (%)| 过去七天内的平均活动数据集。 如果用户在过去三分钟内与视觉对象进行了交互，则将数据集定义为活动状态。 |
| CPU - 数据集最大消耗量 (%)| 过去七天内数据集工作负载的最大 CPU 消耗量。 |
| CPU - 数据集平均消耗量 (%)| 过去七天内数据集工作负载的平均 CPU 消耗量。 |
| 内存 - 数据集平均消耗量 (GB) | 过去七天内数据集工作负载的平均内存消耗。 |
| 内存 - 数据集最大消耗量 (GB) | 过去七天内数据集工作负载的最大内存消耗。|
| 数据集逐出数 | 由于内存压力导致数据集逐出的总次数。 |
| DirectQuery/实时高利用率计数| 过去七天内 DirectQuery/实时连接数超过阈值的 80% 的次数（按三分钟的时间段划分）。 |
| DirectQuery/实时最大利用率计数| 过去七天内 DirectQuery/实时连接数超过阈值的 80% 的最多次数（按一小时的时间段划分）。 |
| DirectQuery/实时最高利用率 | 过去七天内 DirectQuery/实时连接数超过阈值的 80% 的最大次数（按三分钟的时间段划分）。|
| DirectQuery/实时最长发生时间 | DirectQuery/实时连接在一小时内超过 80% 达最多次数时的 UTC 时间。 |
| 刷新总计 | 过去七天内的刷新总次数。 |
| 刷新可靠性 (%) | 过去七天内成功刷新的次数除以刷新总次数。 |
| 刷新平均持续时间（分钟） | 完成刷新的平均时间量。 |
| 刷新平均等待时间（分钟）| 启动刷新之前的平均时间量。 |
| 查询总计 |  过去七天内查询运行的总次数。 |
| 查询总等待计数 | 在执行前必须等待的查询总数。 |
| 查询平均持续时间（毫秒） | 完成查询所花的平均时间。 |
| 查询平均等待时间（毫秒） | 在执行之前，在系统资源上等待的查询的平均时间。 |
|||

#### <a name="dataflow-summary"></a>数据流摘要

| 指标 | 说明 |
| --- | --- |
| 数据流 |  容量中所有工作区的数据流总量。|
| 刷新总计 | 过去七天内的刷新总次数。|  
| 刷新平均持续时间（分钟） | 完成刷新所花的时间。 |
| 刷新平均等待时间（分钟） | 计划时间与刷新实际开始时间之间的延迟。|
| CPU - 数据流最大消耗量 (%) | 过去七天内数据流工作负载的最大 CPU 消耗量。 |
| CPU - 数据流平均消耗量 (%) | 过去七天内数据流工作负载的平均 CPU 消耗量。 |
| 内存 - 数据流最大消耗量 (GB) | 过去七天内数据流工作负载的最大内存消耗。 |
| 内存 - 数据流平均消耗量 (GB) | 过去七天内数据流工作负载的平均内存消耗。 |
|||

#### <a name="paginated-report-summary"></a>分页报表摘要

| 指标 | 说明 |
| --- | --- |
| 分页报表 |  容量中所有工作区的分页报表总量。 |
| 查看总计 | 用户查看所有报表的总次数。 | 
| 行数总计 | 所有报表中数据的总行数。|
| 总时间 | 所有报表的所有阶段（数据检索、处理和呈现）花费的总时间（以毫秒为单位）。 |
| CPU - 分页报表最大消耗量 (%) | 过去七天内分页报表工作负载的最大 CPU 消耗量。 |
| CPU - 分页报表平均消耗量 (%) | 过去七天内分页报表工作负载的平均 CPU 消耗量。 |
| 内存 - 分页报表最大消耗量 (GB) | 过去七天内分页报表工作负载的最大内存消耗。 |
| 内存 - 分页报表平均消耗量 (GB) | 过去七天内分页报表工作负载的平均内存消耗。 |
|||

#### <a name="ai-summary"></a>AI 摘要

| 指标 | 说明 |
| --- | --- |
| AI 函数执行 | 过去七天内的执行总次数。 |
| AI 函数执行可靠性 (%) | 过去七天内成功执行的次数除以执行总次数。 |
| CPU 最大值 (%)| 过去七天内 AI 工作负载的最大 CPU 消耗量。 |
| 内存最大值 (GB) | 过去七天内 AI 工作负载的最大内存消耗量。|
| AI 函数执行最长等待时间 (MS) | 启动执行之前的最大时间量。 |
| AI 函数执行平均等待时间 (MS)| 启动执行之前的平均时间量。 |
| AI 函数执行最长持续时间 (MS) | 完成执行的最大时间量。 |
| AI 函数执行平均持续时间 (MS)| 完成执行的平均时间量。 |
| | |

### <a name="reports"></a>报表

报表提供了更详细的指标。 若要查看你作为管理员的容量的报表，在“报表”中单击“Power BI Premium 容量指标”。 或者，从仪表板单击指标单元格，转到基础报表。 

在报表底部，有五个选项卡：

[**数据集**](#datasets) - 提供容量内有关 Power BI 数据集运行状况的详细指标。
[**分页报表**](#paginated-reports) - 提供容量中分页报表运行状况的详细指标。
[**数据流**](#dataflows) - 提供容量中数据流的刷新详细指标。
[**AI**](#ai)：提供容量内使用的 AI 函数健康状况的详细指标。
[**资源消耗量**](#resource-consumption) - 提供详细资源指标，包括内存和 CPU 高使用率。
[ID 和 Info](#ids-and-info) - 容量、工作区和工作负荷的名称、ID 和所有者。

每个选项卡打开一个页面，可以按容量和日期范围筛选指标。 如果未选择任何筛选器，则报表会默认显示报告了指标的所有容量过去一周的指标。 

### <a name="datasets"></a>数据集

“数据集”页上包含各种区域，其中包括“刷新”、“查询持续时间”、“查询等待”和“数据集”。 可使用页面顶部的按钮导航到各不同区域。

#### <a name="refreshes-area"></a>“刷新”区域

| 报表区域 | 指标 |
| --- | --- |
| 刷新 |  总计：每个数据集的总刷新次数。<br>  可靠性：针对每个数据集完成的刷新百分比。<br>  平均等待时间：计划时间与刷新数据集开始时间之间的平均延迟（以分钟为单位）。<br>  最长等待时间：数据集的最长等待时间（以分钟为单位）。<br>  平均持续时间：刷新数据集的平均持续时间（以分钟为单位）。<br>  最长持续时间：数据集运行时间最长的刷新持续时间（以分钟为单位）。 |
| 平均持续时间（分钟）排名前 5 的数据集 |  具有最长平均刷新持续时间的五个数据集（以分钟为单位）。 |
| 平均等待时间（分钟）排名前 5 的数据集 |  具有最长平均刷新等待时间的五个数据集（以分钟为单位）。 |
| 每小时刷新计数和内存消耗(GB) |  成功、失败和内存占用率，按一小时的时间段划分，以 UTC 时间报告。 |
| 每小时平均刷新等待时间(分钟) |  平均刷新等待时间，按一小时的时间段划分，以 UTC 时间报告。 多个高刷新等待时间峰值表示容量过度运行。 |
|  |  |

#### <a name="query-durations-area"></a>“查询持续时间”区域

| 报表区域 | 指标 |
| --- | --- |
| 查询持续时间 |  此区域中的数据在过去七天内按数据集、工作区和每小时时间段进行划分。<br>  总计:为数据集运行的查询的总数。<br>  平均值:数据集的平均查询持续时间（以毫秒为单位）<br>  最大值：数据集中运行时间最长的查询的持续时间（以毫秒为单位）。|
| 查询持续时间分布 |  查询持续时间直方图由查询持续时间（以毫秒为单位）的 Bucket 数划分为以下类别：<= 30 毫秒、30-100 毫秒、100-300 毫秒、300 毫秒-1 秒、1 秒-3 秒、3 秒-10 秒、10 秒-30 秒和 > 30 秒时间间隔。 较长的查询持续时间和较长的等待时间表示容量过于繁忙。 这也可能意味着，单个数据集会导致问题，需要进一步调查。 |
| 按平均持续时间排名前 5 的数据集 |  具有最长平均查询持续时间的五个数据集（以毫秒为单位）。 |
| 每小时查询持续时间分布 |  按一小时的时间段划分的查询计数和平均持续时间（以毫秒为单位）与内存占用率（以 GB 为单位），以 UTC 时间报告。 |
| DirectQuery/实时连接（> 80% 利用率） |  DirectQuery 或实时连接超过 CPU 利用率的 80% 的次数，按一小时的时间段划分，以 UTC 时间报告。 |
|  |  |

#### <a name="query-waits-area"></a>查询等待区域

| 报表区域 | 指标 |
| --- | --- |
| 查询等待次数 |  此区域中的数据在过去七天内按数据集、工作区和每小时时间段进行划分。<br>  总计:为数据集运行的查询的总数。<br>  等待计数：开始执行之前在系统资源上等待的数据集中的查询数。<br>  平均值:数据集的平均查询等待时间（以毫秒为单位）。<br>  最大值：数据集中等待时间最长的查询的持续时间（以毫秒为单位）。|
| 按平均等待时间排名前 5 的数据集 |  要开始执行查询的具有最长平均等待时间的五个数据集（以毫秒为单位）。 |
| 等待时间分布 |  查询持续时间直方图由查询持续时间（以毫秒为单位）的 Bucket 数划分为以下类别：<= 50 毫秒、50-100 毫秒、100-200 毫秒、200-400 毫秒、400 毫秒-1 秒、1 秒-5 秒和 > 5 秒时间间隔。 |
| 每小时查询等待时间分布 |  按一小时的时间段划分的查询等待计数和平均等待时间（以毫秒为单位）与内存占用率（以 GB 为单位），以 UTC 时间报告。 |
|  |  |

#### <a name="datasets-area"></a>“数据集”区域

| **报表区域** | **指标** |
| --- | --- |
| 数据集大小  |  最大大小：显示的时间段内数据集的最大大小（以 MB 为单位）。 |
| 数据集逐出计数 |  总计:为每个容量执行数据集逐出的总数。 容量面临内存压力时，节点从内存中逐出一个或多个数据集。 首先逐出处于非活动状态（当前没有执行查询/刷新操作）的数据集。 然后按“最近最少使用的项”(LRU) 这一顺序依次逐出。|
| 每小时加载的数据集计数 |  加载到内存中的数据集数与内存占用率（以 GB 为单位），按一小时的时间段划分，以 UTC 时间报告。 |
| 每小时数据集逐出和内存占用率 |  数据集逐出与内存占用率（以 GB 为单位），按一小时的时间段划分，以 UTC 时间报告。 |
| 占用内存百分比 |  内存中活动的总数据集（总内存的百分比）。 活动数据集和可以逐出的所有定义数据集之间的增量。 过去七天按小时显示。 |
|  |  |

### <a name="paginated-reports"></a>分页报表

| **报表区域** | **指标** |
| --- | --- |
| 总体使用情况 |  视图总数：用户查看报表的次数。<br>  行计数：报表中数据的行数。<br>  检索（平均值）：检索报表数据所需的平均时间（以毫秒为单位）。 较长的持续时间可能表示查询速度缓慢或其他数据源问题。 <br>  处理（平均值）：处理报表数据所需的平均时间（以毫秒为单位）。<br> 呈现（平均值）：在浏览器中呈现报表所需的平均时间（以毫秒为单位）。<br>  总时间：报表所有阶段所需的时间（以毫秒为单位）。 |
| 平均数据检索时间排名前 5 的报表 |  具有最长平均数据检索时间的五个报表（以毫秒为单位）。 |
| 平均报表处理时间排名前 5 的报表 |  具有最长平均报表处理时间的五个报表（以毫秒为单位）。 |
| 每小时结果 |  成功、失败和内存占用率，按一小时的时间段划分，以 UTC 时间报告。 |
| 每小时持续时间 |  数据检索与处理和呈现时间，按一小时的时间段划分，以 UTC 时间报告。 |
|  |  |

### <a name="dataflows"></a>数据流

| **报表区域** | **指标** |
| --- | --- |
| 刷新 |  总计:每个数据流的总刷新次数。<br>  可靠性：针对每个数据集完成的刷新百分比。<br>  平均等待时间：计划时间与刷新数据流开始时间之间的平均延迟（以分钟为单位）。<br>  最长等待时间：数据流的最长等待时间（以分钟为单位）。<br>  平均持续时间：刷新数据流的平均持续时间（以分钟为单位）。<br>  最长持续时间：数据流运行时间最长的刷新持续时间（以分钟为单位）。 |
| 按平均刷新持续时间排列的前 5 个数据流 |  具有最长平均刷新持续时间的五个数据流（以分钟为单位）。 |
| 按平均等待时间排列的前 5 个数据流 |  具有最长平均刷新等待时间的五个数据流（以分钟为单位）。 |
| 每小时平均刷新等待时间 |  平均刷新等待时间，按一小时的时间段划分，以 UTC 时间报告。 多个高刷新等待时间峰值表示容量过度运行。 |
| 每小时刷新计数和内存占用率 |  成功、失败和内存占用率，按一小时的时间段划分，以 UTC 时间报告。 |
|  |  |

### <a name="ai"></a>AI

| **报表区域** | **指标** |
| --- | --- |
| AI 内存占用率 | 内存占用率（以 GB 为单位），按一小时的时间段划分，以 UTC 时间报告。 |
| 每小时 AI 函数执行和平均等待时间 | 按一小时时间段划分的 AI 执行和平均等待时间（以毫秒为单位），采用 UTC 时间进行报告。 |
| 总体使用情况 | 总计数：工作区或数据流中的 AI 函数数目。 <br> 系统可靠性：已完成的执行百分比。<br> 平均值等待时间：计划时间和执行开始之间的平均延迟，以毫秒为单位。<br> 最长等待时间：最长等待时间，以毫秒为单位。<br> 平均值持续时间：执行的平均持续时间，以毫秒为单位。<br> 最长持续时间：执行时间最长的持续时间，以毫秒为单位。<br> 平均总大小：AI 函数的输入和输出数据的平均大小（以字节为单位）。 |
| | |

### <a name="resource-consumption"></a>资源消耗

| **报表区域** | **指标** |
| --- | --- |
| CPU 使用率 |  工作负载在一小时内的最大 CPU 消耗（CPU 总容量的百分比）。 过去七天按小时显示。 |
| 内存占用率 |  工作负荷在一小时内的最大内存使用量 (GB)（实线），与工作负荷限制（虚线）重叠。 过去七天按小时显示。 |
|  |  |

### <a name="ids-and-info"></a>ID 和信息

“ID 和信息”选项卡包含以下区域：“容量”、“工作区”、“数据集”、“分页报表”和“数据流”。

#### <a name="capacities-area"></a>容量区域

| 报表区域 | 指标 |
| --- | --- |
| SKU 和工作负载信息 | 容量的 SKU 和工作负载设置。 |
| 管理员 | 容量的管理员名称。 |
|||

#### <a name="workspaces-area"></a>工作区区域

| 报表区域 | 指标 |
| --- | --- |
| 工作区 | 所有工作区的名称和 ID。 |
|||

#### <a name="datasets-area"></a>“数据集”区域

| 报表区域 | 指标 |
| --- | --- |
| 数据集 | 所有数据集的工作区名称和 ID。 |
|||

#### <a name="paginated-reports-area"></a>分页报表区域

| 报表区域 | 指标 |
| --- | --- |
| 分页报表 | 所有分页报表的名称、工作区名称和 ID。 |
|||

#### <a name="dataflows-area"></a>数据流区域

| 报表区域 | 指标 |
| --- | --- |
| 数据流 | 所有数据流的数据流名称、工作区名称和 ID。 |
|||

## <a name="monitor-power-bi-embedded-capacity"></a>监视 Power BI Embedded 容量

可以使用 Power BI Premium Capacity Metrics 应用监视 Power BI Embedded 中的 A SKU 容量。 只要你是容量管理员，这些容量就会显示在报告中。 但是，除非你在 A SKU 上向 Power BI 授予某些权限，否则报告刷新将失败：

1. 在 Azure 门户中打开你的容量。

1. 单击“访问控制 (IAM)”，然后将“Power BI Premium”应用添加到读取者角色。 如果无法按名称找到该应用，也可以通过客户端标识符来添加它：`cb4dc29f-0bf4-402a-8b30-7511498ed654`。

    ![Power BI Embedded 权限](media/service-admin-premium-monitor-capacity/embedded-permissions.png)

> [!NOTE]
> 可以在应用或 Azure门户中监视 Power BI Embedded 容量使用情况，但无法在 Power BI 管理门户中监视。


## <a name="next-steps"></a>后续步骤

> [!div class="nextstepaction"]
> [优化 Power BI Premium 容量](service-premium-capacity-optimize.md)

更多问题？ [在 Power BI 社区提问](https://community.powerbi.com/)

Power BI 推出了 Power BI Premium Gen2 作为预览产品/服务，通过以下方面的改进改善了 Power BI Premium 的体验：
* 性能
* 用户个人许可
* 更大规模
* 改进的指标
* 自动缩放
* 降低管理开销

有关 Power BI Premium Gen2 的详细信息，请参阅 [Power BI Premium 第二代（预览版）](service-premium-what-is.md#power-bi-premium-generation-2-preview)。